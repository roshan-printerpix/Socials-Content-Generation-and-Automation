<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Printerpix Studio - Gallery</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/navbar.css">
  <link rel="stylesheet" href="css/gallery.css">
</head>

<body>
  <div id="navbar-placeholder"></div>

  <div class="container">
    <div class="gallery-header">
      <div class="gallery-controls">
        <div class="custom-dropdown">
          <div class="dropdown-trigger" id="modelDropdownTrigger">
            <span class="dropdown-label" id="modelDropdownLabel">All Models</span>
            <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </div>
          <div class="dropdown-menu" id="modelDropdownMenu">
            <div class="dropdown-header">
              <div class="dropdown-actions">
                <button id="selectAllModelsBtn" class="action-btn">All</button>
                <button id="clearAllModelsBtn" class="action-btn">Clear</button>
              </div>
            </div>
            <div class="dropdown-options">
              <label class="dropdown-option">
                <input type="checkbox" value="imagen-3" checked>
                <span class="checkmark"></span>
                <span class="option-text">Imagen 3</span>
              </label>
              <label class="dropdown-option">
                <input type="checkbox" value="imagen-4" checked>
                <span class="checkmark"></span>
                <span class="option-text">Imagen 4</span>
              </label>
              <label class="dropdown-option">
                <input type="checkbox" value="imagen-4-ultra" checked>
                <span class="checkmark"></span>
                <span class="option-text">Imagen 4 Ultra</span>
              </label>
              <label class="dropdown-option">
                <input type="checkbox" value="veo-3" checked>
                <span class="checkmark"></span>
                <span class="option-text">Veo 3</span>
              </label>
            </div>
          </div>
        </div>
        
        <div class="custom-dropdown">
          <div class="dropdown-trigger" id="tagDropdownTrigger">
            <span class="dropdown-label" id="tagDropdownLabel">All Tags</span>
            <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </div>
          <div class="dropdown-menu" id="tagDropdownMenu">
            <div class="dropdown-header">
              <div class="dropdown-actions">
                <button id="selectAllTagsBtn" class="action-btn">All</button>
                <button id="clearAllTagsBtn" class="action-btn">Clear</button>
              </div>
            </div>
            <div class="dropdown-options" id="tagDropdownOptions">
              <!-- Tag options will be populated dynamically -->
            </div>
          </div>
        </div>
        
        <div class="view-toggle">
          <button id="gridViewBtn" class="view-btn active">Grid</button>
          <button id="listViewBtn" class="view-btn">List</button>
        </div>
        
        <div class="notify-toggle">
          <button id="notifyModeBtn" class="notify-btn">Notify</button>
        </div>
      </div>
    </div>

    <div class="gallery-stats" id="galleryStats">
      <div class="stat-item">
        <span class="stat-number" id="totalImages">0</span>
        <span class="stat-label">Total Images</span>
      </div>
      <div class="stat-item">
        <span class="stat-number" id="totalSize">0 MB</span>
        <span class="stat-label">Storage Used</span>
      </div>
    </div>

    <div class="gallery-content">
      <div id="loadingIndicator" class="loading-container">
        <div class="spinner"></div>
        <p>Loading gallery...</p>
      </div>

      <div id="errorMessage" class="error-message" style="display: none;">
        <p>Failed to load gallery. Please check your Supabase configuration.</p>
        <button id="retryBtn" class="retry-btn">Retry</button>
      </div>

      <div id="emptyGallery" class="empty-gallery" style="display: none;">
        <div class="empty-icon">üñºÔ∏è</div>
        <h3>No Images Found</h3>
        <p>Your gallery is empty. Generate some images to see them here!</p>
        <a href="/" class="generate-link">Generate Images</a>
      </div>

      <div id="galleryGrid" class="gallery-grid" style="display: none;">
        <!-- Images will be dynamically loaded here -->
      </div>
    </div>
  </div>

  <!-- Image Modal -->
  <div id="imageModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <button class="modal-close" id="modalClose">&times;</button>
      <img id="modalImage" src="" alt="Gallery Image">
      <div class="modal-info">
        <h3 id="modalTitle">Image Details</h3>
        <div class="modal-details">
          <div class="detail-item">
            <span class="detail-label">File Name:</span>
            <span class="detail-value" id="modalFileName">-</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Size:</span>
            <span class="detail-value" id="modalFileSize">-</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Created:</span>
            <span class="detail-value" id="modalCreated">-</span>
          </div>
        </div>
        
        <div class="modal-tags-section">
          <h4>Product Tags</h4>
          <div class="current-tags" id="currentTags">
            <!-- Current tags will be displayed here -->
          </div>
          <div class="add-tags-section">
            <select id="tagSelect" class="tag-select">
              <option value="">Add a tag...</option>
            </select>
            <button id="addTagBtn" class="add-tag-btn">Add</button>
          </div>
        </div>
        
        <div class="modal-actions">
          <button id="downloadBtn" class="action-btn download-btn">Download</button>
          <button id="deleteBtn" class="action-btn delete-btn">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Proceed Button -->
  <div id="proceedButton" class="proceed-button" style="display: none;">
    <div class="proceed-content">
      <span id="selectedCount">0 images selected</span>
      <button id="proceedBtn" class="proceed-btn">Proceed</button>
    </div>
  </div>

  <!-- Email Modal -->
  <div id="emailModal" class="modal-overlay" style="display: none;">
    <div class="email-modal-content">
      <div class="email-header">
        <h2>Send Images via Email</h2>
        <button class="modal-close" id="emailModalClose">&times;</button>
      </div>
      <div class="email-body">
        <div class="email-form">
          <div class="form-group">
            <label for="recipientEmail">To:</label>
            <input type="email" id="recipientEmail" placeholder="Enter recipient email address" required>
          </div>
          <div class="form-group">
            <label for="emailSubject">Subject:</label>
            <input type="text" id="emailSubject" value="Images from Printerpix Studio" required>
          </div>
          <div class="form-group">
            <label for="emailMessage">Message:</label>
            <textarea id="emailMessage" rows="6" placeholder="Add your message here...">Hi,

I'm sharing some images with you from Printerpix Studio. Please find the attached images below.

Best regards</textarea>
          </div>
          <div class="selected-images-preview">
            <h4>Selected Images (<span id="emailImageCount">0</span>):</h4>
            <div id="emailImageGrid" class="email-image-grid">
              <!-- Selected images will be shown here -->
            </div>
          </div>
        </div>
      </div>
      <div class="email-actions">
        <button id="cancelEmailBtn" class="cancel-btn">Cancel</button>
        <button id="sendEmailBtn" class="send-btn">Send Email</button>
      </div>
    </div>
  </div>

  <script src="js/navbar.js"></script>
  <script src="js/gallery.js"></script>
  <script>
    // Initialize navbar for gallery page
    initNavbar('gallery');
  </script>
</body>
</html>